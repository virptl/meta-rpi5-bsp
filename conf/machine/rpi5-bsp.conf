# -----------------------------------------------------------------------------
# Custom Raspberry Pi 5 BSP Machine
# -----------------------------------------------------------------------------

#@TYPE: Machine
#@NAME: rpi5-bsp
#@DESCRIPTION: Raspberry Pi 5 BSP focused on stable boot and debug access

# -----------------------------------------------------------------------------
# Base machine
# -----------------------------------------------------------------------------
require conf/machine/raspberrypi5.conf

# -----------------------------------------------------------------------------
# Machine overrides (CRITICAL)
# -----------------------------------------------------------------------------
# raspberrypi5 MUST come first for linux-raspberrypi BSP resolution
MACHINEOVERRIDES =. "raspberrypi5:"
MACHINEOVERRIDES .= ":rpi5-bsp"

# -----------------------------------------------------------------------------
# Console
# -----------------------------------------------------------------------------
ENABLE_UART = "1"
SERIAL_CONSOLES = "115200;ttyAMA0"
APPEND += "console=ttyAMA0,115200 console=tty1"

# -----------------------------------------------------------------------------
# Image types
# -----------------------------------------------------------------------------
IMAGE_FSTYPES += "wic wic.bmap"

# -----------------------------------------------------------------------------
# Kernel
# -----------------------------------------------------------------------------
PREFERRED_PROVIDER_virtual/kernel = "linux-raspberrypi"

